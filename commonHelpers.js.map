{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["// import axios from 'axios';\n\nconst URL = 'https://pixabay.com/api/';\nconst API_KEY = '45076495-063a30a4096c3d430f822662d';\n\naxios.defaults.baseURL = URL;\n\nexport function searchImagesByQuery({ page = 1, per_page = 15, q = '' } = {}) {\n  return axios\n    .get('', {\n      params: {\n        page,\n        per_page,\n        q,\n        key: API_KEY,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n      },\n    })\n    .then(({ data }) => data);\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport function renderImageSearch({ hits }) {\n  const gallery = document.querySelector('.gallery');\n  const markup = hits\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n    <li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${largeImageURL}\" target=\"_blank\">\n        <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\">\n      </a>\n      <div class=\"gallery-info\">\n        <div class=\"info-item\">\n          <p class=\"info-label\">Likes</p>\n          <p class=\"info-value\">${likes}</p>\n        </div>\n        <div class=\"info-item\">\n          <p class=\"info-label\">Views</p>\n          <p class=\"info-value\">${views}</p>\n        </div>\n        <div class=\"info-item\">\n          <p class=\"info-label\">Comments</p>\n          <p class=\"info-value\">${comments}</p>\n        </div>\n        <div class=\"info-item\">\n          <p class=\"info-label\">Downloads</p>\n          <p class=\"info-value\">${downloads}</p>\n        </div>\n      </div>\n    </li>`\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { searchImagesByQuery } from './js/pixabay-api';\nimport { renderImageSearch } from './js/render-functions';\n\nconst gallery = document.querySelector('.gallery');\nconst searchForm = document.querySelector('.search-form');\nconst loadingSpinner = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('[data-action=\"load-more\"]');\n\nconst params = {\n  page: 1,\n  pageSize: 15,\n  q: '',\n  maxPage: 0,\n};\n\nhideLoadMoreBtn();\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nsearchForm.addEventListener('submit', handleSearch);\n\nasync function handleSearch(event) {\n  event.preventDefault();\n  gallery.innerHTML = '';\n  loadMoreBtn.removeEventListener('click', handleLoadMore);\n  hideLoadMoreBtn();\n\n  const form = event.currentTarget;\n  params.q = form.elements.query.value.trim();\n\n  if (!params.q) {\n    gallery.innerHTML = '';\n    return;\n  }\n\n  params.page = 1;\n  showLoadingSpinner();\n\n  try {\n    const { hits, totalHits } = await searchImagesByQuery(params);\n\n    if (totalHits === 0) {\n      iziToast.error({\n        titleColor: '#FFFFFF',\n        backgroundColor: '#EF4040',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        messageColor: '#FFFFFF',\n        position: 'topRight',\n      });\n      hideLoadMoreBtn();\n      return;\n    }\n\n    params.maxPage = Math.ceil(totalHits / params.pageSize);\n    renderImageSearch({ hits });\n\n    if (params.maxPage > 1) {\n      showLoadMoreBtn();\n      loadMoreBtn.addEventListener('click', handleLoadMore);\n    } else {\n      hideLoadMoreBtn();\n    }\n\n    lightbox.refresh();\n  } catch (err) {\n  } finally {\n    hideLoadingSpinner();\n  }\n}\n\nasync function handleLoadMore() {\n  if (params.page >= params.maxPage) {\n    hideLoadMoreBtn();\n    return;\n  }\n\n  params.page += 1;\n  showLoadingSpinner();\n\n  try {\n    const { hits } = await searchImagesByQuery(params);\n    renderImageSearch({ hits });\n\n    if (params.page >= params.maxPage) {\n      iziToast.info({\n        titleColor: '#FFFFFF',\n        backgroundColor: '#FFA500',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        messageColor: '#FFFFFF',\n        position: 'topRight',\n      });\n      hideLoadMoreBtn();\n    }\n\n    lightbox.refresh();\n\n    scrollToNextPosition();\n  } catch (err) {\n  } finally {\n    hideLoadingSpinner();\n    form.reset();\n  }\n}\n\nfunction scrollToNextPosition() {\n  const galleryItem = gallery.querySelector('.gallery-item');\n  if (galleryItem) {\n    const { height } = galleryItem.getBoundingClientRect();\n    window.scrollBy({\n      top: height * 2,\n      behavior: 'smooth',\n    });\n  }\n}\n\nfunction showLoadingSpinner() {\n  loadingSpinner.style.display = 'block';\n}\n\nfunction hideLoadingSpinner() {\n  loadingSpinner.style.display = 'none';\n}\n\nfunction showLoadMoreBtn() {\n  loadMoreBtn.style.display = 'block';\n}\n\nfunction hideLoadMoreBtn() {\n  loadMoreBtn.style.display = 'none';\n}\n"],"names":["URL","API_KEY","searchImagesByQuery","page","per_page","q","data","renderImageSearch","hits","gallery","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","searchForm","loadingSpinner","loadMoreBtn","params","hideLoadMoreBtn","lightbox","SimpleLightbox","handleSearch","event","handleLoadMore","form","showLoadingSpinner","totalHits","iziToast","showLoadMoreBtn","hideLoadingSpinner","scrollToNextPosition","galleryItem","height"],"mappings":"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"}